---
title: New to Node.js
date: 2019-10-20 00:37:05
updated: 2019-10-20 00:37:05
categories:
- New to
tags:
- Node.js
---

需要以下工具:
- NVM
- Node.js
- Yarn

## Node.js的安装和配置

### 安装

安装使用版本管理器，详见[[nvm]]

### 配置

#### 环境变量

nvm已经为我们创建了一个环境变量`NVM_SYMLINK`，并追加进了`Path`之中。

## NPM

[[npm]]

### 配置文件备忘

主要是修改仓库源，我在用户目录下的配置如下（包含了pnmp）：
```npmrc
#pnpm
store-dir=D:\env\pnpm\store
cache-dir=D:\env\pnpm\cache
global-dir=D:\env\pnpm\global
global-bin-dir=D:\env\pnpm\global_bin
state-dir=D:\env\pnpm\state

#npm
cache=D:\env\npm\cache
# registry=http://registry.npmjs.org
registry=http://registry.npmmirror.com
strict-ssl=false
```

```.yarnrc
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# - 翻译：这是自动生成的文件，不要直接修改。- 我就要改。
# yarn lockfile v1

registry "http://registry.npmmirror.com"
cache-folder "D:\\env\\yarn-cache"
global-folder "D:\\env\\yarn-global"
prefix "D:\\env\\yarn-data"

```

### npm常用命令和缩写

见下文。

### 使用NRM切换仓库

[nrm](https://github.com/Pana/nrm)

## Corepack
（仅供了解）
目前有很多包管理器，比如npm、Yarn、pnpm等等。参与不同项目时，成员除了代码还需要操心包管理器的选择，还有版本的选择。
Corepack为解决以上团队中包管理器的同步问题而生。Corepack会尝试读取`package.json`中的[`"packageManager"`](https://nodejs.org/dist/latest/docs/api/packages.html#packagemanager)，按需下载并执行，类似于Gradle Wrapper。

### 启用
Corepack目前是一个**实验性功能**所以需要手动启用：`corepack enable`，从Node.js v16.10开始随node一起提供, 因此可以直接运行。

### 使用

#### Build

像往常一样使用你的包管理器。比如：
- 在 Yarn 项目使用`yarn install`
- 在pnpm 项目使用`pnpm install`
- npm 项目中运行`npm`。

Corepack 将捕获这些调用，并视情况而定：
- 如果本地项目为您正在使用的包管理器配置，Corepack 将静默下载并缓存最新的兼容版本。
- 如果本地项目配置为不同的包管理器，Corepack 将要求您使用正确的包管理器再次运行该命令 - 从而避免损坏您的安装工件。
- 如果本地项目没有为任何包管理器配置，Corepack 将假定您知道自己在做什么，并将使用任何包管理器版本已被固定为“已知良好的版本”。

#### 新建包

在`package.json`文件的 `packageManager`字段填入。比如：
```json
{
  "packageManager": "yarn@3.2.3+sha224.953c8233f7a92884eee2de69a1b92d1f2ec1655e66d08071ba9a02fa"
}
```
后面的哈希是可选的。


## Yarn的安装和配置

我不太想尝Corepack的鲜，也不自然不想按照Yarn2的文档通过Corepack去使用Yarn（这是文档上提供的唯一方式）。因此至少当下我会坚持使用Yarn1。

### 安装

```powershell
npm i -g yarn
```

### 配置



### 常用命令和缩写

| 作用                 | 命令                    | npm                            | 缩写                      | 文档                                                                                                                      |
| -------------------- | ----------------------- | ------------------------------ | ------------------------- | ------------------------------------------------------------------------------------------------------------------------- |
| 为项目安装所有依赖   | `yarn install`          | `npm install`                  | `yarn` `npm i`            | [yarn install](https://classic.yarnpkg.com/en/docs/cli/install)                                                           |
| 添加依赖             | `yarn add [package]`    | `npm install [package] --save` | `npm i [package]`         | [yarn add](https://classic.yarnpkg.com/en/docs/cli/add) [npm-install](https://docs.npmjs.com/cli/v8/commands/npm-install) |
| 移除依赖             | `yarn remove [package]` | `npm uninstall [package]`      | `npm r [package]`         | [npm-uninstall](https://docs.npmjs.com/cli/v8/commands/npm-uninstall)                                                     |
| 更新全部依赖         | `yarn upgrade `         | `npm update`                   | `npm up`或者`npm upgrade` | [npm-update](https://docs.npmjs.com/cli/v8/commands/npm-update)                                                           |
| 新建项目（跳过问卷，可选指定一个initializer） | `yarn init`             | `npm init -y`                  |                           | [npm-init  npm Docs](https://docs.npmjs.com/cli/v8/commands/npm-init)                                                     |


### 常见问题

##### yarn.lock是否应该参与版本控制

答：应该
见[yarn.lock | Yarn](https://classic.yarnpkg.com/lang/en/docs/yarn-lock/#toc-check-into-source-control)


## 参考
1. [npmrc | npm Docs](https://docs.npmjs.com/cli/v8/configuring-npm/npmrc)
2. [CLI Commands | npm Docs](https://docs.npmjs.com/cli/v8/commands)
3. [Corepack | Node.js v19.0.0 Documentation](https://nodejs.org/dist/latest/docs/api/corepack.html)
4. [GitHub - nodejs/corepack: Zero-runtime-dependency package acting as bridge between Node projects and their package managers](https://github.com/nodejs/corepack)
5. [Node.js Corepack - 简书](https://www.jianshu.com/p/c239ed5dedd6)
6. [Getting Started | Yarn](https://classic.yarnpkg.com/en/docs/getting-started)
7. [CLI Introduction | Yarn](https://classic.yarnpkg.com/en/docs/cli/)
8. [Migrating from npm | Yarn](https://classic.yarnpkg.com/en/docs/migrating-from-npm)





